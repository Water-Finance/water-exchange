{"ast":null,"code":"import _regeneratorRuntime from\"C:/Users/peter/Desktop/water-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"C:/Users/peter/Desktop/water-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:/Users/peter/Desktop/water-exchange/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useEffect,useState}from'react';import BigNumber from'bignumber.js';import{useMulticallContract}from'./useContract';import ERC20_INTERFACE from'../constants/abis/erc20';import priceContracts from'../constants/eggPriceContracts';var useGetPriceData=function useGetPriceData(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),data=_useState2[0],setData=_useState2[1];var multicallContract=useMulticallContract();useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var cakeAddress,busdAddress,lpAddress,calls,_yield$multicallContr,_yield$multicallContr2,result,_result$map,_result$map2,cakeAmount,busdAmount,cake,busd,cakePrice;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;if(!multicallContract){_context.next=14;break;}cakeAddress=priceContracts.cakeAddress,busdAddress=priceContracts.busdAddress,lpAddress=priceContracts.lpAddress;calls=[[cakeAddress,ERC20_INTERFACE.encodeFunctionData(\"balanceOf\",[lpAddress])],[busdAddress,ERC20_INTERFACE.encodeFunctionData(\"balanceOf\",[lpAddress])]];_context.next=6;return multicallContract.aggregate(calls);case 6:_yield$multicallContr=_context.sent;_yield$multicallContr2=_slicedToArray(_yield$multicallContr,1);result=_yield$multicallContr2[0];_result$map=result.map(function(r){return ERC20_INTERFACE.decodeFunctionResult(\"balanceOf\",r);}),_result$map2=_slicedToArray(_result$map,2),cakeAmount=_result$map2[0],busdAmount=_result$map2[1];cake=new BigNumber(cakeAmount);busd=new BigNumber(busdAmount);cakePrice=busd.div(cake).toNumber();setData(cakePrice);case 14:_context.next=19;break;case 16:_context.prev=16;_context.t0=_context[\"catch\"](0);console.error('Unable to fetch price data:',_context.t0);case 19:case\"end\":return _context.stop();}}},_callee,null,[[0,16]]);}));return function fetchData(){return _ref.apply(this,arguments);};}();fetchData();},[multicallContract]);return data;};export default useGetPriceData;","map":{"version":3,"sources":["C:/Users/peter/Desktop/water-exchange/src/hooks/useGetPriceData.ts"],"names":["useEffect","useState","BigNumber","useMulticallContract","ERC20_INTERFACE","priceContracts","useGetPriceData","data","setData","multicallContract","fetchData","cakeAddress","busdAddress","lpAddress","calls","encodeFunctionData","aggregate","result","map","r","decodeFunctionResult","cakeAmount","busdAmount","cake","busd","cakePrice","div","toNumber","console","error"],"mappings":"idAAA,OAASA,SAAT,CAAoBC,QAApB,KAAoC,OAApC,CACA,MAAOC,CAAAA,SAAP,KAAsB,cAAtB,CACA,OAASC,oBAAT,KAAqC,eAArC,CACA,MAAOC,CAAAA,eAAP,KAA4B,yBAA5B,CACA,MAAOC,CAAAA,cAAP,KAA2B,gCAA3B,CAIA,GAAMC,CAAAA,eAAe,CAAG,QAAlBA,CAAAA,eAAkB,EAAM,eACJL,QAAQ,CAAS,CAAT,CADJ,wCACrBM,IADqB,eACfC,OADe,eAG5B,GAAMC,CAAAA,iBAAiB,CAAGN,oBAAoB,EAA9C,CAEAH,SAAS,CAAC,UAAM,CACd,GAAMU,CAAAA,SAAS,0FAAG,0TAEXD,iBAFW,0BAGLE,WAHK,CAGkCN,cAHlC,CAGLM,WAHK,CAGQC,WAHR,CAGkCP,cAHlC,CAGQO,WAHR,CAGqBC,SAHrB,CAGkCR,cAHlC,CAGqBQ,SAHrB,CAINC,KAJM,CAIE,CACZ,CAACH,WAAD,CAAcP,eAAe,CAACW,kBAAhB,CAAmC,WAAnC,CAAgD,CAACF,SAAD,CAAhD,CAAd,CADY,CAEZ,CAACD,WAAD,CAAcR,eAAe,CAACW,kBAAhB,CAAmC,WAAnC,CAAgD,CAACF,SAAD,CAAhD,CAAd,CAFY,CAJF,uBASWJ,CAAAA,iBAAiB,CAACO,SAAlB,CAA4BF,KAA5B,CATX,2GASLG,MATK,uCAUqBA,MAAM,CAACC,GAAP,CAAW,SAAAC,CAAC,QAAEf,CAAAA,eAAe,CAACgB,oBAAhB,CAAqC,WAArC,CAAkDD,CAAlD,CAAF,EAAZ,CAVrB,4CAULE,UAVK,iBAUOC,UAVP,iBAWNC,IAXM,CAWC,GAAIrB,CAAAA,SAAJ,CAAcmB,UAAd,CAXD,CAYNG,IAZM,CAYC,GAAItB,CAAAA,SAAJ,CAAcoB,UAAd,CAZD,CAaNG,SAbM,CAaMD,IAAI,CAACE,GAAL,CAASH,IAAT,EAAeI,QAAf,EAbN,CAcZnB,OAAO,CAACiB,SAAD,CAAP,CAdY,yFAiBdG,OAAO,CAACC,KAAR,CAAc,6BAAd,cAjBc,qEAAH,kBAATnB,CAAAA,SAAS,0CAAf,CAqBAA,SAAS,GACV,CAvBQ,CAuBN,CAACD,iBAAD,CAvBM,CAAT,CAyBA,MAAOF,CAAAA,IAAP,CACD,CA/BD,CAiCA,cAAeD,CAAAA,eAAf","sourcesContent":["import { useEffect, useState } from 'react'\nimport BigNumber from 'bignumber.js'\nimport { useMulticallContract } from './useContract'\nimport ERC20_INTERFACE from '../constants/abis/erc20'\nimport priceContracts from '../constants/eggPriceContracts'\n\n\n\nconst useGetPriceData = () => {\n  const [data, setData] = useState<number>(0)\n\n  const multicallContract = useMulticallContract();\n\n  useEffect(() => {\n    const fetchData = async () => {\n      try {\n        if(multicallContract){\n          const {cakeAddress, busdAddress, lpAddress} = priceContracts;\n          const calls = [\n            [cakeAddress, ERC20_INTERFACE.encodeFunctionData(\"balanceOf\", [lpAddress])],\n            [busdAddress, ERC20_INTERFACE.encodeFunctionData(\"balanceOf\", [lpAddress])],\n          ];\n\n          const [result] = await multicallContract.aggregate(calls);\n          const [cakeAmount, busdAmount] = result.map(r=>ERC20_INTERFACE.decodeFunctionResult(\"balanceOf\", r));\n          const cake = new BigNumber(cakeAmount);\n          const busd = new BigNumber(busdAmount);\n          const cakePrice = busd.div(cake).toNumber();\n          setData(cakePrice)\n        }\n      } catch (error) {\n        console.error('Unable to fetch price data:', error)\n      }\n    }\n\n    fetchData()\n  }, [multicallContract])\n\n  return data\n}\n\nexport default useGetPriceData\n"]},"metadata":{},"sourceType":"module"}